(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{40:function(e,t,n){},41:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),s=n(32),o=n.n(s),i=(n(40),n(2)),l=n(3),r=n(4),j=(n(41),n(5)),d=n.n(j),u=n(0),h=function(){var e=Object(c.useContext)(B),t=e.state,n=e.dispatch,a=Object(c.useRef)(null),s=Object(c.useState)(""),o=Object(i.a)(s,2),j=o[0],h=o[1],b=Object(c.useState)([]),f=Object(i.a)(b,2),m=f[0],p=f[1],O=Object(l.f)();Object(c.useEffect)((function(){d.a.Modal.init(a.current)}),[]);return Object(u.jsxs)("nav",{children:[Object(u.jsxs)("div",{className:"nav-wrapper white",style:{padding:"5px"},children:[Object(u.jsx)(r.b,{to:t?"/":"/login",className:"brand-logo left",children:"Socialgram"}),Object(u.jsx)("ul",{id:"nav-mobile",className:"right hide-on-med-and-down",children:t?[Object(u.jsx)("li",{children:Object(u.jsx)("i",{"data-target":"modal1",className:"large material-icons modal-trigger",style:{color:"black"},children:"search"})},"1"),Object(u.jsx)("li",{children:Object(u.jsx)(r.b,{to:"/profile",children:"Profile"})},"2"),Object(u.jsx)("li",{children:Object(u.jsx)(r.b,{to:"/createpost",children:"Create Post"})},"3"),Object(u.jsx)("li",{children:Object(u.jsx)(r.b,{to:"/myposts",children:"My Posts"})},"4"),Object(u.jsx)("li",{children:Object(u.jsx)(r.b,{to:"/messages",children:"Message"})},"5"),Object(u.jsx)("li",{children:Object(u.jsx)("button",{className:"waves-effect waves-light btn #c62828 red darken-3\r\n",style:{margin:"0px"},onClick:function(){localStorage.clear(),n({type:"CLEAR"}),O("/login")},children:"Logout"})},"6")]:[Object(u.jsx)("li",{children:Object(u.jsx)(r.b,{to:"/login",children:"Login"})}),Object(u.jsx)("li",{children:Object(u.jsx)(r.b,{to:"/signup",children:"Signup"})})]})]}),Object(u.jsxs)("div",{id:"modal1",class:"modal",ref:a,style:{color:"black"},children:[Object(u.jsxs)("div",{className:"modal-content",children:[Object(u.jsx)("input",{type:"text",placeholder:"search users",value:j,onChange:function(e){return t=e.target.value,h(t),void fetch("/search-users",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t})}).then((function(e){return e.json()})).then((function(e){p(e.user)}));var t}}),Object(u.jsx)("ul",{className:"collection",children:m.map((function(e){return Object(u.jsx)(r.b,{to:e._id!==t._id?"/profile/"+e._id:"/profile",onClick:function(){d.a.Modal.getInstance(a.current).close(),h("")},children:Object(u.jsx)("li",{className:"collection-item",children:e.email})})}))})]}),Object(u.jsx)("div",{className:"modal-footer",children:Object(u.jsx)("button",{className:"modal-close waves-effect waves-green btn-flat",onClick:function(){return h("")},children:"close"})})]})]})},b=function(){var e=Object(l.f)(),t=Object(c.useState)(""),n=Object(i.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(""),j=Object(i.a)(o,2),h=j[0],b=j[1],f=Object(c.useState)(""),m=Object(i.a)(f,2),p=m[0],O=m[1],g=Object(c.useState)(""),x=Object(i.a)(g,2),v=x[0],y=x[1],w=Object(c.useState)(void 0),N=Object(i.a)(w,2),S=N[0],k=N[1];Object(c.useEffect)((function(){S&&C()}),[S]);var C=function(){a&&h&&p?/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(h)?fetch("/signup",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a,email:h,password:p,pic:S})}).then((function(e){return e.json()})).then((function(t){t.error?d.a.toast({html:t.error,classes:"#d32f2f red darken-2"}):(d.a.toast({html:t.message,classes:"#2e7d32 green darken-3"}),e("/login"))})):d.a.toast({html:"Invalid Email!",classes:"#d32f2f red darken-2"}):d.a.toast({html:"Please enter all the fields",classes:"#d32f2f red darken-2"})},_=function(){v?function(){var e=new FormData;e.append("file",v),e.append("upload_preset","socialgram"),e.append("cloud_name","theatulsinghk"),fetch("https://api.cloudinary.com/v1_1/theatulsinghk/image/upload",{method:"post",body:e}).then((function(e){return e.json()})).then((function(e){console.log(e),k(e.url)})).catch((function(e){return console.log(e)}))}():C()};return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("div",{className:"card input-field",children:[Object(u.jsx)("h2",{className:"brand-logo",children:"Socialgram"}),Object(u.jsx)("input",{type:"text",placeholder:"Name",value:a,onChange:function(e){return s(e.target.value)}}),Object(u.jsx)("input",{type:"text",placeholder:"Email",value:h,onChange:function(e){return b(e.target.value)}}),Object(u.jsx)("input",{type:"password",placeholder:"Password",value:p,onChange:function(e){return O(e.target.value)}}),Object(u.jsxs)("div",{className:"file-field ",children:[Object(u.jsxs)("div",{className:"waves-effect waves-light btn #2196f3 blue \r ",children:[Object(u.jsx)("span",{children:"Upload Profile Pic"}),Object(u.jsx)("input",{type:"file",onChange:function(e){return y(e.target.files[0])}})]}),Object(u.jsx)("div",{className:"file-path-wrapper",children:Object(u.jsx)("input",{className:"file-path validate ",type:"text",placeholder:"Optional"})})]}),Object(u.jsx)("button",{className:"waves-effect waves-light btn #2196f3 blue darken-1\r ",onClick:function(){return _()},children:"SignUp"}),Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsx)(r.b,{to:"/login",children:"Already have an account?"})]})})},f=function(){var e=Object(c.useState)([]),t=Object(i.a)(e,2),n=t[0],a=t[1],s=Object(c.useContext)(B),o=s.state;s.dispatch;Object(c.useEffect)((function(){fetch("/allposts",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){a(e.allposts)}))}),[n]);return Object(u.jsx)("div",{className:"Home",children:n.map((function(e){return Object(u.jsxs)("div",{className:"card homecard",children:[Object(u.jsxs)("h5",{style:{padding:"10px"},children:[e.postedby.name,e.postedby._id==o._id&&Object(u.jsx)("i",{className:"material-icons",style:{float:"right"},onClick:function(){return t=e._id,void fetch("/deletepost/"+t,{method:"delete",headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){console.log(e),d.a.toast({html:"Post Deleted !",classes:"#d32f2f red darken-2"})}));var t},children:"delete"})]}),Object(u.jsx)("div",{className:"card-image",children:Object(u.jsx)("img",{className:"item",src:e.photo})}),Object(u.jsxs)("div",{className:"card-content",children:[e.likes.includes(o._id)?Object(u.jsx)("i",{className:"material-icons",onClick:function(){var t;t=e._id,fetch("/unlike",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({postid:t})}).then((function(e){return e.json()})).then((function(e){})).catch((function(e){console.log(e)}))},children:"thumb_down"}):Object(u.jsx)("i",{className:"material-icons",onClick:function(){var t;t=e._id,fetch("/like",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({postid:t})}).then((function(e){return e.json()})).then((function(e){})).catch((function(e){console.log(e)}))},children:"thumb_up"}),Object(u.jsxs)("h6",{children:[e.likes.length," likes ",e.comments.length," Comments"]}),Object(u.jsx)("h5",{children:e.caption}),e.comments.map((function(e){return Object(u.jsxs)("h6",{children:[Object(u.jsx)("span",{style:{color:"#2196f3"},children:e.postedby.name})," ",e.text]},e._id)})),Object(u.jsx)("form",{onSubmit:function(t){var n,c;t.preventDefault(),n=t.target[0].value,c=e._id,fetch("/comment",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({text:n,postid:c})}).then((function(e){return e.json()})).then((function(e){})).catch((function(e){console.log(e)}))},children:Object(u.jsx)("input",{type:"text",placeholder:"add a coment"})})]})]},e._id)}))})},m=n(19),p=function(){var e=Object(c.useContext)(B),t=e.state,n=e.dispatch,a=Object(c.useState)([]),s=Object(i.a)(a,2),o=s[0],l=s[1],j=Object(c.useState)(""),d=Object(i.a)(j,2),h=d[0],b=d[1];return Object(c.useEffect)((function(){fetch("/myposts",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){l(e.myposts)}))}),[]),Object(c.useEffect)((function(){if(h){var e=new FormData;e.append("file",h),e.append("upload_preset","socialgram"),e.append("cloud_name","theatulsinghk"),fetch("https://api.cloudinary.com/v1_1/theatulsinghk/image/upload",{method:"post",body:e}).then((function(e){return e.json()})).then((function(e){fetch("/updatepic",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({pic:e.url})}).then((function(e){return e.json()})).then((function(e){console.log(e),localStorage.setItem("user",JSON.stringify(Object(m.a)(Object(m.a)({},t),{},{pic:e.pic}))),n({type:"UPDATEPIC",payload:e.pic})}))})).catch((function(e){return console.log(e)}))}}),[h]),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("div",{style:{display:"flex",justifyContent:"space-around",margin:"20px auto",maxWidth:"600px",borderBottom:"1px solid grey"},children:[Object(u.jsxs)("div",{children:[Object(u.jsx)("img",{style:{width:"150px",height:"150px",borderRadius:"80px"},src:t?t.pic:"https://res.cloudinary.com/theatulsinghk/image/upload/v1638706287/download_kyzd9t.png"}),Object(u.jsxs)("div",{className:"file-field ",children:[Object(u.jsxs)("div",{className:"waves-effect waves-light btn-small #2196f3 blue \r ",style:{margin:"10px"},children:[Object(u.jsx)("span",{children:"Update Pic"}),Object(u.jsx)("input",{type:"file",onChange:function(e){return b(e.target.files[0])}})]}),Object(u.jsx)("div",{className:"file-path-wrapper"})]})]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("h4",{children:t?t.name:"loading.."}),Object(u.jsxs)("h6",{children:[" ",t?t.email:"loading.."," "]}),Object(u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"118%"},children:[Object(u.jsx)(r.b,{to:"/myposts",children:Object(u.jsxs)("h5",{children:[o.length," Posts"]})}),Object(u.jsx)(r.b,{to:"/getfollower",children:Object(u.jsxs)("h5",{children:[t?t.followers.length:"0"," Followers"]})}),Object(u.jsx)(r.b,{to:"/getfollowing",children:Object(u.jsxs)("h5",{children:[t?t.following.length:"0"," Following"]})})]})]})]}),Object(u.jsx)("div",{className:"gallery",children:o.map((function(e){return Object(u.jsx)("img",{className:"item",src:e.photo})}))})]})},O=function(){var e=Object(c.useContext)(B),t=(e.state,e.dispatch),n=Object(l.f)(),a=Object(c.useState)(""),s=Object(i.a)(a,2),o=s[0],j=s[1],h=Object(c.useState)(""),b=Object(i.a)(h,2),f=b[0],m=b[1];return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("div",{className:"card input-field",children:[Object(u.jsx)("h2",{className:"brand-logo",children:"Socialgram"}),Object(u.jsx)("input",{type:"text",placeholder:"Email",value:o,onChange:function(e){return j(e.target.value)}}),Object(u.jsx)("input",{type:"password",placeholder:"Password",value:f,onChange:function(e){return m(e.target.value)}}),Object(u.jsx)("button",{className:"waves-effect waves-light btn #2196f3 blue darken-1\r\n",onClick:function(){fetch("/signin",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o,password:f})}).then((function(e){return e.json()})).then((function(e){localStorage.setItem("jwt",e.token),localStorage.setItem("user",JSON.stringify(e.user)),e.error?d.a.toast({html:e.error,classes:"#d32f2f red darken-2"}):(d.a.toast({html:e.message,classes:"#2e7d32 green darken-3"}),t({type:"USER",payload:e.user}),n("/"))}))},children:"Login"}),Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsx)(r.b,{to:"/signup",children:"Don't have an account?"}),Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsx)(r.b,{to:"/reset",children:"Forget Password?"})]})})},g=function(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(""),o=Object(i.a)(s,2),r=o[0],j=o[1],h=Object(c.useState)(""),b=Object(i.a)(h,2),f=b[0],m=b[1],p=Object(l.f)();Object(c.useEffect)((function(){f&&fetch("/createpost",{method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({caption:n,photo:f}),user:localStorage.getItem("user")}).then((function(e){return e.json()})).then((function(e){e.error?d.a.toast({html:e.error,classes:"#d32f2f red darken-2"}):(d.a.toast({html:e.message,classes:"#2e7d32 green darken-3"}),p("/myposts"))})).catch((function(e){return console.log(e)}))}),[f]);return Object(u.jsxs)("div",{className:"card input-field",children:[Object(u.jsx)("input",{className:"input-field",type:"text",placeholder:"caption",value:n,onChange:function(e){return a(e.target.value)}}),Object(u.jsxs)("div",{className:"file-field ",children:[Object(u.jsxs)("div",{className:"waves-effect waves-light btn #2196f3 blue \r ",children:[Object(u.jsx)("span",{children:"Upload Image"}),Object(u.jsx)("input",{type:"file",onChange:function(e){return j(e.target.files[0])}})]}),Object(u.jsx)("div",{className:"file-path-wrapper",children:Object(u.jsx)("input",{className:"file-path validate ",type:"text"})})]}),Object(u.jsxs)("button",{className:"waves-effect waves-light btn #2196f3 blue darken-1\r\n",type:"submit",name:"action",onClick:function(){return function(){var e=new FormData;e.append("file",r),e.append("upload_preset","socialgram"),e.append("cloud_name","theatulsinghk"),fetch("https://api.cloudinary.com/v1_1/theatulsinghk/image/upload",{method:"post",body:e}).then((function(e){return e.json()})).then((function(e){console.log(e),m(e.url)})).catch((function(e){return console.log(e)}))}()},children:["Post",Object(u.jsx)("i",{class:"material-icons right",children:"send"})]})]})},x=function(e,t){return"USER"===t.type?t.payload:"CLEAR"===t.type?null:"UPDATE"===t.type?Object(m.a)(Object(m.a)({},e),{},{followers:t.payload.followers,following:t.payload.following}):"UPDATEPIC"===t.type?Object(m.a)(Object(m.a)({},e),{},{pic:t.payload}):e},v=function(){var e=Object(c.useContext)(B),t=e.state,n=e.dispatch,a=Object(c.useState)(null),s=Object(i.a)(a,2),o=s[0],r=s[1],j=Object(l.g)().userid,d=Object(c.useState)(""),h=Object(i.a)(d,2),b=h[0],f=h[1];Object(c.useEffect)((function(){t&&f(!t.following.includes(j))}),[t]),Object(c.useEffect)((function(){fetch("/profile/".concat(j),{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){r(e)})).catch((function(e){return console.log(e)}))}),[o]);return Object(u.jsx)(u.Fragment,{children:o?Object(u.jsxs)("div",{children:[Object(u.jsxs)("div",{style:{display:"flex",justifyContent:"space-around",margin:"20px auto",maxWidth:"600px",borderBottom:"1px solid grey"},children:[Object(u.jsx)("div",{children:Object(u.jsx)("img",{style:{width:"150px",height:"150px",borderRadius:"80px"},src:o.pic?o.pic:"https://res.cloudinary.com/theatulsinghk/image/upload/v1638706287/download_kyzd9t.png"})}),Object(u.jsxs)("div",{children:[Object(u.jsx)("h4",{children:void 0!==o.user.name?o.user.name:"loading.."}),Object(u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"118%"},children:[Object(u.jsxs)("h5",{children:[void 0!==o.posts?o.posts.length:"loading.."," posts"]}),Object(u.jsxs)("h5",{children:[" ",void 0!==o.user.followers?o.user.followers.length:"loading.."," Followers"]}),Object(u.jsxs)("h5",{children:[" ",void 0!==o.user.following?o.user.following.length:"loading.."," Following"]}),b?Object(u.jsx)("button",{className:"waves-effect waves-light btn #2196f3 blue darken-1\r ",onClick:function(){return fetch("/follow",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({followid:j})}).then((function(e){return e.json()})).then((function(e){n({type:"UPDATE",payload:{following:e.following,followers:e.followers}}),localStorage.setItem("user",JSON.stringify(e)),f(!1)})),void fetch("/conversation/".concat(j),{method:"post",headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}})},children:"follow"}):Object(u.jsx)("button",{className:"waves-effect waves-light btn #2196f3 blue darken-1\r ",onClick:function(){return fetch("/unfollow",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({followid:j})}).then((function(e){return e.json()})).then((function(e){n({type:"UPDATE",payload:{following:e.following,followers:e.followers}}),localStorage.setItem("user",JSON.stringify(e)),f(!0)})),void fetch("/deleteconversation/".concat(j),{method:"post",headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}})},children:"unfollow"})]})]})]}),Object(u.jsx)("div",{className:"gallery",children:o.posts.map((function(e){return Object(u.jsx)("img",{className:"item",src:e.photo})}))})]}):Object(u.jsx)("h2",{children:"Loading..."})})},y=function(){var e=Object(c.useState)([]),t=Object(i.a)(e,2),n=t[0],a=t[1],s=Object(c.useContext)(B),o=s.state;s.dispatch;Object(c.useEffect)((function(){fetch("/myposts",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){a(e.myposts)}))}),[n]);return Object(u.jsx)("div",{className:"Home",children:n.map((function(e){return Object(u.jsxs)("div",{className:"card homecard",children:[Object(u.jsxs)("h5",{style:{padding:"10px"},children:[e.postedby.name,e.postedby._id==o._id&&Object(u.jsx)("i",{className:"material-icons",style:{float:"right"},onClick:function(){return t=e._id,void fetch("/deletepost/"+t,{method:"delete",headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){console.log(e),d.a.toast({html:"Post Deleted !",classes:"#d32f2f red darken-2"})}));var t},children:"delete"})]}),Object(u.jsx)("div",{className:"card-image",children:Object(u.jsx)("img",{className:"item",src:e.photo})}),Object(u.jsxs)("div",{className:"card-content",children:[e.likes.includes(o._id)?Object(u.jsx)("i",{className:"material-icons",onClick:function(){var t;t=e._id,fetch("/unlike",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({postid:t})}).then((function(e){return e.json()})).then((function(e){})).catch((function(e){console.log(e)}))},children:"thumb_down"}):Object(u.jsx)("i",{className:"material-icons",onClick:function(){var t;t=e._id,fetch("/like",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({postid:t})}).then((function(e){return e.json()})).then((function(e){})).catch((function(e){console.log(e)}))},children:"thumb_up"}),Object(u.jsxs)("h6",{children:[e.likes.length," likes ",e.comments.length," Comments"]}),Object(u.jsx)("h5",{children:e.caption}),e.comments.map((function(t){return Object(u.jsxs)("h6",{children:[Object(u.jsx)("span",{style:{color:"#2196f3"},children:t.postedby.name})," ",t.text," ",Object(u.jsx)("i",{className:"material-icons",style:{float:"right"},onClick:function(){return n=e._id,c=t,void fetch("/deletecomment",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({postid:n,comment:c})}).then((function(e){return e.json()})).then((function(e){})).catch((function(e){console.log(e)}));var n,c},children:"delete"})]},t._id)})),Object(u.jsx)("form",{onSubmit:function(t){var n,c;t.preventDefault(),n=t.target[0].value,c=e._id,fetch("/comment",{method:"put",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("jwt")},body:JSON.stringify({text:n,postid:c})}).then((function(e){return e.json()})).then((function(e){})).catch((function(e){console.log(e)}))},children:Object(u.jsx)("input",{type:"text",placeholder:"add a coment"})})]})]},e._id)}))})},w=n(27),N=n(29),S=n.n(N),k=n(30),C=function(){var e=Object(c.useContext)(B).state,t=Object(l.g)().recieverid,n=Object(c.useState)(),a=Object(i.a)(n,2),s=a[0],o=a[1],j=Object(c.useState)([]),d=Object(i.a)(j,2),h=d[0],b=d[1],f=Object(c.useState)(""),m=Object(i.a)(f,2),p=m[0],O=m[1],g=Object(c.useState)(""),x=Object(i.a)(g,2),v=x[0],y=x[1],N=Object(c.useState)(""),C=Object(i.a)(N,2),_=C[0],I=C[1],A=Object(c.useState)([]),E=Object(i.a)(A,2),z=(E[0],E[1]),F=Object(c.useState)(0),J=Object(i.a)(F,2),P=J[0],T=(J[1],Object(c.useRef)()),D=Object(c.useState)(null),U=Object(i.a)(D,2),R=U[0],L=U[1],M=Object(c.useRef)(Object(k.a)("ws://localhost:8900"));Object(c.useEffect)((function(){M.current=Object(k.a)("ws://localhost:8900"),M.current.on("getMessage",(function(e){L({sender:e.senderId,text:e.text,createdAt:Date.now()})}))}),[t]),Object(c.useEffect)((function(){O((function(e){return[].concat(Object(w.a)(e),[[R]])}))}),[R,t]),Object(c.useEffect)((function(){e&&M.current.emit("addUser",e._id)}),[e,t]),Object(c.useEffect)((function(){z(null),O(""),fetch("/getconversation/"+t,{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){z(e),I(e[0]._id.toString()),e.map((function(e){fetch("/getmessage/"+e._id.toString(),{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){O([].concat(Object(w.a)(p),[e]))})).catch((function(e){return console.log(e)}))}))})).catch((function(e){return console.log(e)}))}),[P,t]),Object(c.useEffect)((function(){var e;null===(e=T.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[p,t]),Object(c.useEffect)((function(){fetch("/profile/".concat(t),{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){o(e.user)})).catch((function(e){return console.log(e)}))}),[t]),Object(c.useEffect)((function(){fetch("/getfollowing",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){b(e)})).catch((function(e){return console.log(e)}))}),[]);return Object(u.jsxs)("div",{className:"messages",children:[Object(u.jsx)("div",{className:"followings",style:{flex:"4"},children:Object(u.jsx)("ul",{className:"collection",children:h.map((function(e){return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("li",{className:"collection-item avatar",style:{margin:"10px"},children:[Object(u.jsx)("img",{src:e.pic?e.pic:"https://res.cloudinary.com/theatulsinghk/image/upload/v1638706287/download_kyzd9t.png",alt:"",className:"circle"}),Object(u.jsx)("span",{className:"title",children:e.name?e.name:"loading..."}),Object(u.jsx)("a",{href:"/messages/"+e._id,className:"secondary-content",children:Object(u.jsx)("i",{className:"material-icons",children:"chat"})})]})})}))})}),s?Object(u.jsxs)("div",{className:"chatsec",children:[Object(u.jsx)("div",{className:"nav-wrapper white nameg",children:Object(u.jsx)(r.b,{to:"/profile/"+s._id,className:"",children:s.name})}),Object(u.jsx)("div",{className:"chatbox",style:{margin:"20px",padding:"10px",flex:"8"},children:p?Object(u.jsx)("div",{className:"cardContent",children:p.map((function(e){return e.map((function(e){return Object(u.jsx)("div",{ref:T,children:e.sender==JSON.parse(localStorage.getItem("user"))._id?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"mymessage",children:e.text}),Object(u.jsx)("span",{className:"mymessagebtm",children:S()(e.createdAt).fromNow()})]}):Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"message",children:e.text}),Object(u.jsx)("span",{className:"messagebtm",children:S()(e.createdAt).fromNow()})]})})}))}))}):"loading..."}),Object(u.jsxs)("div",{className:"cardaction",children:[Object(u.jsx)("textarea",{className:"messagetext",placeholder:"write something...",value:v,onChange:function(e){y(e.target.value)}}),Object(u.jsx)("button",{className:"waves-effect waves-light btn-small #2196f3 blue bla ",style:{margin:"15px"},children:Object(u.jsx)("i",{className:"material-icons",onClick:function(){return M.current.emit("sendMessage",{senderId:e._id,receiverId:t,text:v}),void fetch("/message",{method:"post",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify({text:v,sender:JSON.parse(localStorage.getItem("user"))._id.toString(),conversationid:_})}).then((function(e){return e.json()})).then((function(e){O([].concat(Object(w.a)(p),[[e]]))}))},children:"send"})})]})]}):Object(u.jsx)("div",{children:"loading..."}),Object(u.jsx)("div",{style:{flex:"2"}})]})},_=function(){var e=Object(c.useState)([]),t=Object(i.a)(e,2),n=t[0],a=t[1];return Object(c.useEffect)((function(){fetch("/getfollowing",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){a(e)})).catch((function(e){return console.log(e)}))}),[]),Object(u.jsxs)("div",{className:"messages",children:[Object(u.jsx)("div",{className:"followings",style:{flex:"4"},children:Object(u.jsx)("ul",{className:"collection",children:n.map((function(e){return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("li",{className:"collection-item avatar",children:[Object(u.jsx)("img",{src:e.pic?e.pic:"https://res.cloudinary.com/theatulsinghk/image/upload/v1638706287/download_kyzd9t.png",alt:"",className:"circle"}),Object(u.jsx)("span",{className:"title",children:e.name?e.name:"loading..."}),Object(u.jsx)(r.b,{to:"/messages/"+e._id,className:"secondary-content",children:Object(u.jsx)("i",{className:"material-icons",children:"chat"})})]})})}))})}),Object(u.jsx)("div",{style:{flex:"2"}})]})},I=function(e){var t=Object(c.useState)([]),n=Object(i.a)(t,2),a=n[0],s=n[1];return Object(c.useEffect)((function(){fetch("/getfollow",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){s(e)})).catch((function(e){return console.log(e)}))}),[]),Object(u.jsx)(u.Fragment,{children:Object(u.jsx)("div",{className:"followings",style:{flex:"4",margin:"30px auto",maxWidth:"700px"},children:Object(u.jsxs)("ul",{className:"collection",children:[Object(u.jsx)("h5",{style:{margin:"10px 30px",padding:"5px",borderBottom:"1px solid rgb(228, 228, 228)"},children:"Your Followers"}),a.map((function(e){return Object(u.jsx)(u.Fragment,{children:Object(u.jsx)(r.b,{to:"/profile/"+e._id,children:Object(u.jsxs)("li",{className:"collection-item avatar",style:{margin:"10px"},children:[Object(u.jsx)("img",{src:e.pic?e.pic:"https://res.cloudinary.com/theatulsinghk/image/upload/v1638706287/download_kyzd9t.png",alt:"",className:"circle"}),Object(u.jsx)("span",{className:"title",children:e.name?e.name:"loading..."})]})})})}))]})})})},A=function(){var e=Object(l.f)(),t=Object(c.useState)(""),n=Object(i.a)(t,2),a=n[0],s=n[1];return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("div",{className:"card input-field",children:[Object(u.jsx)("h2",{className:"brand-logo",children:"Socialgram"}),Object(u.jsx)("input",{type:"text",placeholder:"Email",value:a,onChange:function(e){return s(e.target.value)}}),Object(u.jsx)("button",{className:"waves-effect waves-light btn #2196f3 blue darken-1\n",onClick:function(){fetch("/reset-password",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a})}).then((function(e){return e.json()})).then((function(t){s(""),t.error?d.a.toast({html:t.error,classes:"#d32f2f red darken-2"}):(d.a.toast({html:t.message,classes:"#2e7d32 green darken-3"}),e("/login"))}))},children:"Use Email"}),Object(u.jsx)("br",{}),Object(u.jsx)("br",{})]})})},E=function(){var e=Object(l.g)().token,t=Object(l.f)(),n=Object(c.useState)(""),a=Object(i.a)(n,2),s=a[0],o=a[1];return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("div",{className:"card input-field",children:[Object(u.jsx)("h2",{className:"brand-logo",children:"Socialgram"}),Object(u.jsx)("input",{type:"password",placeholder:"Enter New Password",value:s,onChange:function(e){return o(e.target.value)}}),Object(u.jsx)("button",{className:"waves-effect waves-light btn #2196f3 blue darken-1\n",onClick:function(){fetch("/new-password",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:s,token:e})}).then((function(e){return e.json()})).then((function(e){e.error?d.a.toast({html:e.error,classes:"#d32f2f red darken-2"}):(d.a.toast({html:e.message,classes:"#2e7d32 green darken-3"}),t("/login"))}))},children:"Set Password"}),Object(u.jsx)("br",{}),Object(u.jsx)("br",{})]})})},z=function(e){var t=Object(c.useState)([]),n=Object(i.a)(t,2),a=n[0],s=n[1];return Object(c.useEffect)((function(){fetch("/getfollowing",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(e){s(e)})).catch((function(e){return console.log(e)}))}),[]),Object(u.jsx)(u.Fragment,{children:Object(u.jsx)("div",{className:"followings",style:{flex:"4",margin:"30px auto",maxWidth:"700px"},children:Object(u.jsxs)("ul",{className:"collection",children:[Object(u.jsx)("h5",{style:{margin:"10px 30px",padding:"5px",borderBottom:"1px solid rgb(228, 228, 228)"},children:"You Follow"}),a.map((function(e){return Object(u.jsx)(u.Fragment,{children:Object(u.jsx)(r.b,{to:"/profile/"+e._id,children:Object(u.jsxs)("li",{className:"collection-item avatar",style:{margin:"10px"},children:[Object(u.jsx)("img",{src:e.pic?e.pic:"https://res.cloudinary.com/theatulsinghk/image/upload/v1638706287/download_kyzd9t.png",alt:"",className:"circle"}),Object(u.jsx)("span",{className:"title",children:e.name?e.name:"loading..."})]})})})}))]})})})},B=Object(c.createContext)(),F=function(){var e=Object(l.f)(),t=JSON.parse(localStorage.getItem("user")),n=Object(c.useContext)(B),a=(n.state,n.dispatch),s=Object(l.e)();return Object(c.useEffect)((function(){t?a({type:"USER",payload:t}):s.pathname.startsWith("/reset")||e("/login")}),[]),Object(u.jsxs)(l.c,{children:[Object(u.jsx)(l.a,{path:"/",element:Object(u.jsx)(f,{})}),Object(u.jsx)(l.a,{path:"/messages",element:Object(u.jsx)(_,{})}),Object(u.jsx)(l.a,{path:"/signup",element:Object(u.jsx)(b,{})}),Object(u.jsx)(l.a,{path:"/login",element:Object(u.jsx)(O,{})}),Object(u.jsx)(l.a,{exact:!0,path:"/profile",element:Object(u.jsx)(p,{})}),Object(u.jsx)(l.a,{exact:!0,path:"/profile/:userid",element:Object(u.jsx)(v,{})}),Object(u.jsx)(l.a,{path:"/createpost",element:Object(u.jsx)(g,{})}),Object(u.jsx)(l.a,{path:"/myposts",element:Object(u.jsx)(y,{})}),Object(u.jsx)(l.a,{exact:!0,path:"/messages/:recieverid",element:Object(u.jsx)(C,{})}),Object(u.jsx)(l.a,{path:"/getfollowing",element:Object(u.jsx)(z,{})}),Object(u.jsx)(l.a,{path:"/getfollower",element:Object(u.jsx)(I,{})}),Object(u.jsx)(l.a,{exact:!0,path:"/reset",element:Object(u.jsx)(A,{})}),Object(u.jsx)(l.a,{path:"/reset/:token",element:Object(u.jsx)(E,{})})]})};var J=function(){var e=Object(c.useReducer)(x,null),t=Object(i.a)(e,2),n=t[0],a=t[1];return Object(u.jsx)("div",{className:"App",children:Object(u.jsx)(B.Provider,{value:{state:n,dispatch:a},children:Object(u.jsxs)(r.a,{children:[Object(u.jsx)(h,{}),Object(u.jsx)(F,{})]})})})},P=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,49)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,s=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),s(e),o(e)}))};o.a.render(Object(u.jsx)(a.a.StrictMode,{children:Object(u.jsx)(J,{})}),document.getElementById("root")),P()}},[[48,1,2]]]);
//# sourceMappingURL=main.6f6352c6.chunk.js.map